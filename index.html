<!DOCTYPE html>
<html>
  <head>
    <title>Exemple Zoiper5</title>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  </head>
  <body>
    <h1>Exemple Zoiper5</h1>

    <input type="text" id="number" placeholder="Numéro de téléphone" />
    <button id="callButton">Appeler</button>

    <script src="https://cdn.zoiper.com/zoiper5/2.17.4/zoiper5.js"></script>
    <script>
      // Connexion SIP Zadarma
      var sipUsername = "326263";
      var sipPassword = "reyF2Ju31t";
      var sipDomain = "sip.zadarma.com";

      // Initialisation de Zoiper5
      zoiper5.init({
        debug: true,
        sip: {
          wsServers: ["wss://" + sipDomain + ":8089/ws"],
          uri: sipUsername + "@" + sipDomain,
          authorizationUser: sipUsername,
          password: sipPassword,
          transportOptions: {
            wsPingInterval: 60,
            wsPingTimeout: 30,
            traceSip: true
          },
          iceRestart: false
        }
      });

      // Gestionnaire de clic pour le bouton d'appel
      var callButton = document.getElementById("callButton");
      callButton.onclick = function () {
        var number = document.getElementById("number").value;
        if (!number) {
          alert("Veuillez saisir un numéro de téléphone");
          return;
        }

        var session = zoiper5.newSession("call-audio", {
          audio_remote: document.getElementById("audio-remote"),
          audio_local: document.getElementById("audio-local")
        });

        session.on("connecting", function () {
          console.log("En train de se connecter...");
        });

        session.on("connected", function () {
          console.log("Connecté !");
        });

        session.on("disconnected", function () {
          console.log("Déconnecté !");
        });

        session.call(number);
      };
    </script>
  </body>
</html>
